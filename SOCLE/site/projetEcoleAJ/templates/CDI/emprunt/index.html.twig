{% extends 'base.html.twig' %}

{% block title %}Hello AdminController!{% endblock %}

{% block body %}
<div id="divTab" class="d-flex align-center">
    <div id="idTabDemande" data-nom="demande" class="col p-3">Emprunt demand√©</div>
    <div id="idTabEmprunt" data-nom="emprunt" class="col p-3">Emprunt en cours</div>
    <div id="idTabRendu" data-nom="rendu" class="col p-3">Ouvrage Rendu</div>
</div>  
<div id="idDivDemande" class="d-none">
    <table class="table table-striped table-bordered table-hover">
        <thead>
            <tr>
                <th class="text-nowrap">Id</th>
                <th class="text-nowrap">Statutt</th>
                <th class="text-nowrap">date de la demande</th>
                <th class="text-nowrap">date de l'emprunt</th>
                <th class="text-nowrap">Date de Restitution</th>                
                <th class="text-nowrap">Membre</th>
                <th class="text-nowrap">Ouvrage</th>
            </tr>
        </thead>
        <tbody>
            {% for emprunt in emprunts %}
                {% if emprunt.statut.id == 1 %}
                <tr>
                    <td>{{emprunt.id}}</td>
                    <td>{{emprunt.statut.libelle}}</td>                    
                    <td>{{ emprunt.dateDemande | date('d/m/Y') }}</td>
                    <td>
                        {% if emprunt.dateEmprunt is not null %}
                            {{ emprunt.dateEmprunt | date('d/m/Y') }}</td>
                        {% endif %}
                    </td>
                    <td>
                        {% if emprunt.dateRetour is not null %}
                            {{ emprunt.dateRetour | date('d/m/Y')}}
                            {% endif %}
                    </td>
                    <td>
                        <a href="{{ path('membre_affichage', {'id': emprunt.membre.id}) }}">
                            {{ emprunt.membre.prenom }} {{ emprunt.membre.nom }}
                        </a>
                    </td>
                    <td>
                        <a href="{{ path('ouvrage_affichage', {'id': emprunt.ouvrage.id}) }}">
                            {{ emprunt.ouvrage.titre }}
                                        
                    </td>


                    <td>
                        <a href="{{ path('emprunt_affichage', {'id': emprunt.id}) }}" class="btn btn-secondary">lire</a>
                        <a href="{{ path('emprunt_edition', {'id': emprunt.id}) }}" class="btn btn-secondary">editer</a>
                    </td>
                </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>
<div id="idDivEmprunt" class="d-none">
    <table class="table table-striped table-bordered table-hover">
        <thead>
            <tr>
                <th class="text-nowrap">Id</th>
                <th class="text-nowrap">Statutt</th>
                <th class="text-nowrap">date de la demande</th>
                <th class="text-nowrap">date de l'emprunt</th>
                <th class="text-nowrap">Date de Restitution</th>                
                <th class="text-nowrap">Membre</th>
                <th class="text-nowrap">Ouvrage</th>
            </tr>
        </thead>
        <tbody>
            {% for emprunt in emprunts %}
                {% if emprunt.statut.id == 2 %}
                <tr>
                    <td>{{emprunt.id}}</td>
                    <td>{{emprunt.statut.libelle}}</td>                    
                    <td>{{ emprunt.dateDemande | date('d/m/Y') }}</td>
                    <td>
                        {% if emprunt.dateEmprunt is not null %}
                            {{ emprunt.dateEmprunt | date('d/m/Y') }}</td>
                        {% endif %}
                    </td>
                    <td>
                        {% if emprunt.dateRetour is not null %}
                            {{ emprunt.dateRetour | date('d/m/Y')}}
                            {% endif %}
                    </td>
                    <td>
                        <a href="{{ path('membre_affichage', {'id': emprunt.membre.id}) }}">
                            {{ emprunt.membre.prenom }} {{ emprunt.membre.nom }}
                        </a>
                    </td>
                    <td>
                        <a href="{{ path('ouvrage_affichage', {'id': emprunt.ouvrage.id}) }}">
                            {{ emprunt.ouvrage.titre }}
                                        
                    </td>


                    <td>
                        <a href="{{ path('emprunt_affichage', {'id': emprunt.id}) }}" class="btn btn-secondary">lire</a>
                        <a href="{{ path('emprunt_edition', {'id': emprunt.id}) }}" class="btn btn-secondary">editer</a>
                    </td>
                </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>
<div id="idDivRendu" class="d-none">
    <table class="table table-striped table-bordered table-hover">
        <thead>
            <tr>
                <th class="text-nowrap">Id</th>
                <th class="text-nowrap">Statutt</th>
                <th class="text-nowrap">date de la demande</th>
                <th class="text-nowrap">date de l'emprunt</th>
                <th class="text-nowrap">Date de Restitution</th>                
                <th class="text-nowrap">Membre</th>
                <th class="text-nowrap">Ouvrage</th>
            </tr>
        </thead>
        <tbody>
            {% for emprunt in emprunts %}
                {% if emprunt.statut.id == 3 %}
                <tr>
                    <td>{{emprunt.id}}</td>
                    <td>{{emprunt.statut.libelle}}</td>                    
                    <td>{{ emprunt.dateDemande | date('d/m/Y') }}</td>
                    <td>
                        {% if emprunt.dateEmprunt is not null %}
                            {{ emprunt.dateEmprunt | date('d/m/Y') }}</td>
                        {% endif %}
                    </td>
                    <td>
                        {% if emprunt.dateRetour is not null %}
                            {{ emprunt.dateRetour | date('d/m/Y')}}
                            {% endif %}
                    </td>
                    <td>
                        <a href="{{ path('membre_affichage', {'id': emprunt.membre.id}) }}">
                            {{ emprunt.membre.prenom }} {{ emprunt.membre.nom }}
                        </a>
                    </td>
                    <td>
                        <a href="{{ path('ouvrage_affichage', {'id': emprunt.ouvrage.id}) }}">
                            {{ emprunt.ouvrage.titre }}
                                        
                    </td>


                    <td>
                        <a href="{{ path('emprunt_affichage', {'id': emprunt.id}) }}" class="btn btn-secondary">lire</a>
                        <a href="{{ path('emprunt_edition', {'id': emprunt.id}) }}" class="btn btn-secondary">editer</a>
                    </td>
                </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>
<script>

document.addEventListener("DOMContentLoaded", function(){
    let tabDemande=document.getElementById("idTabDemande")
    let tabEmprunt=document.getElementById("idTabEmprunt")
    let tabRendu=document.getElementById("idTabRendu")
    let divDemande=document.getElementById("idDivDemande")
    let divEmprunt=document.getElementById("idDivEmprunt")
    let divRendu=document.getElementById("idDivRendu")

    tabDemande.addEventListener("click", action)
    tabEmprunt.addEventListener("click", action)
    tabRendu.addEventListener("click", action)

    function action(e){
        if(e.target.dataset.nom=="demande"){
            divDemande.classList.remove("d-none")
             divEmprunt.classList.add("d-none")
             divRendu.classList.add("d-none")
        } else if(e.target.dataset.nom=="emprunt"){
            divDemande.classList.add("d-none")
            divEmprunt.classList.remove("d-none")
             divRendu.classList.add("d-none")
        } else if(e.target.dataset.nom=="rendu"){
            divDemande.classList.add("d-none")
             divEmprunt.classList.add("d-none")
            divRendu.classList.remove("d-none")
        }
    
    }

})


</script>
{% endblock %}
